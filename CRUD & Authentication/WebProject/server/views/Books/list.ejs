<%- include ../partials/header.ejs %>
<%- include ../partials/main_nav.ejs %>

<main class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h3"><%= title %></h1>
    <% if (displayName) { %>
      <a href="/books/add" class="btn btn-success">Add Book</a>
    <% } %>
  </div>

  <% // Show only if error message was passed %>
  <% if (typeof error !== 'undefined' && error) { %>
    <div class="alert alert-danger"><%= error %></div>
  <% } %>


  <div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
      <thead class="table-primary">
        <tr>
          <th>Title</th>
          <th>Author</th>
          <th class="text-center">Year</th>
          <th>Description</th>
          <th class="text-end">Price</th>
          <% if (displayName) { %>
            <th class="text-center">Actions</th>
          <% } %>
        </tr>
      </thead>
      <tbody>
        <% if (BookList && BookList.length > 0) { %>
          <% BookList.forEach(function (book) { %>
            <tr>
              <td><%= book.name %></td>
              <td><%= book.author %></td>
              <td class="text-center"><%= book.published || '' %></td>
              <td><%= book.description %></td>
              <td class="text-end">
                <% if (typeof book.price !== 'undefined') { %>
                  $<%= Number(book.price).toFixed(2) %>
                <% } %>
              </td>
              <% if (displayName) { %>
                <td class="text-center">
                  <a href="/books/edit/<%= book._id %>" class="btn btn-sm btn-outline-primary me-1">
                    Edit
                  </a>
                  <a href="/books/delete/<%= book._id %>"
                     class="btn btn-sm btn-outline-danger"
                     onclick="return confirmDelete('<%= book.name %>');">
                    Delete
                  </a>
                </td>
              <% } %>
            </tr>
          <% }); %>
        <% } else { %>
          <tr>
            <td colspan="6" class="text-center text-muted">
              No books in the directory yet.
              <% if (displayName) { %>
                <a href="/books/add">Add the first one</a>.
              <% } %>
            </td>
          </tr>
        <% } %>
      </tbody>
    </table>
  </div>
</main>

<%- include ../partials/footer.ejs %>
